# IPSJ OS研究会 (2016.5) 論文構成

## タイトル・アブストラクト

*0.5ページ*

### タイトル
MPI通信パターンに基くSDN制御を高速化するカーネルモジュールの試作と評価

### 著者
1. 高橋 慧智
2. Khureltulga Dashdavaa
3. 木戸 善之
4. 伊達 進
5. 下條 真司

### アブストラクト
SDN-MPIは，ネットワーク内のパケットフローを動的に制御可能にするSDNアーキテクチャを，
並列分散環境で用いられるプロセス間通信ライブラリMPIに応用する試みである．
これまで開発してきたSDN-MPIのプロトタイプは，個別のMPI関数を単独で実行した際の
性能向上を実証した．しかし，実際のアプリケーションは複数の異なるMPI関数を使用
するため，アプリケーションの通信パターンに応じて適切なネットワーク制御を実行
する必要がある．本論文では，MPIが送出する各パケットに通信パターンをエンコード
したタグを付与し，タグに基いてネットワークでパケット制御する手法を提案する．
提案手法におけるパケットのタグ付けを高速化するために，MPIライブラリと
連係するカーネルモジュールを試作し，評価した．

## 1. はじめに

*1ページ*

### 2.1 動的インターコネクト制御の必要性
- コンピュータ・クラスタがHPCシステムにおいて技術的トレンドである
- インターコネクトは複雑化と大規模化にともない構築コストが増大している
- 静的なインターコネクト制御では、アプリケーションがネットワーク資源を活用しきれない場合がある
- アプリケーションの通信パターンに応じてインターコネクトを動的に制御すれば、より効率的にネットワーク資源を活用できる

### 2.2 SDN-MPIのコンセプト
- MPIとは、分散メモリ型並列コンピュータで標準的に用いられるプロセス間通信ライブラリである
- SDNとは、ネットワークをプログラムにより集中制御するネットワークアーキテクチャである
- SDN-MPIは、SDNをMPIに適用することにより、MPIアプリケーションの通信パターンに合わせて、インターコネクトを動的に制御する
    - 図: SDN-MPIの概念図
- 当研究グループの先行研究では、SDN-MPIのプロトタイプ実装でMPI通信関数の性能向上を実証した
    - 引用: SDN-MPI Bcast論文
    - 引用: SDN-MPI Allreduce論文

## 2. 問題

*0.5ページ*

- 先行研究では個々のMPI通信関数の高速化に注目していた
- 実際のMPIアプリケーションは、様々なMPI関数を異なる引数で呼び出す
- SDNコントローラが、MPIアプリケーションの通信状況に応じて適切なネットワークを制御を行うためには、現在実行されているMPI関数に関する情報を把握する必要がある
- 本論文で提案するアーキテクチャは、下記の課題を解決する:
    - MPIアプリケーション中の現在実行されているMPI関数をSDNコントローラに同期する
    - MPI関数の引数として与えられる、送信プロセス、受信プロセス、通信グループなどの情報をSDNコントローラに同期する
    - 上記の2つの機能をを少ないオーバーヘッドで実現する

## 3. 提案

*2ページ*

### 3.1 提案の概要
- MPIライブラリが送信するパケットに、MPI関数に関する情報を「タグ」として埋め込む
- SDNスイッチとコントローラは、パケットのタグを参照し、パケットの処理方法を動的に決定する
- 「タグ」としてパケットに埋め込まれる情報は下記の通り:
    - MPI関数の種類
    - 送信プロセスのランク
    - 受信プロセスのランク
    - 通信グループ (コミュニケータ)
- パケット自体にMPI関数に関する情報を埋め込むことにより、下記のオーバーヘッド
    が削減される
    - MPIアプリケーションとSDNコントローラ間の通信が不要
    - SDNスイッチにフロールールがインストールされれば、SDNスイッチとSDNコント
        ローラ間の通信が不要

### 3.2 アーキテクチャ
- 図: 提案アーキテクチャの概念図 (クラスタ全体)
- 図: 提案アーキテクチャの概念図 (1ノード内)

### 3.3 タグ付け機構
- タグを埋め込む場所としては様々な候補があるが、提案アーキテクチャでは以下の理由からMACアドレスフィールドを用いた:
    - SDNスイッチがハードウェアで処理できる
    - TCAMを消費せず、BCAMのみで処理できるため、インストールできるルールの数が多い
- MPIライブラリが送出するパケットのMACアドレスを動的に書き換えるためには、
    カーネルモジュールを用いた
- 他のRawソケット方法やTAPデバイスを用いる方法に比べ、以下の利点がある:
    - MPIアプリケーションを実行するユーザにroot権限が不要
    - 既存のMPIライブラリに加える変更が最小で済む
    - 書き換え対象として使用できるMACアドレスの数が無制限

## 4. 評価

*1.5ページ*

### 4.1 評価の概要

- 評価環境 (milkクラスタ) の説明
    - トポロジ
    - 計算ノードとスイッチの仕様
    - ソフトウェアのバージョン
- 同期機構の動作確認とオーバーヘッドの測定の2つの評価を行う

### 4.3 タグ付けのオーバーヘッド
- 提案アーキテクチャによって導入されるオーバーヘッドの大半は、タグ付けに由来
    する
- タグ付けのオーバーヘッドを測定するために、2ノード間でSend/Recvを実行し、
    提案システムあり/なしでスループットと遅延を計測した
    - 図: 2ノード間のスループットの比較
    - 図: 2ノード間の遅延の比較
- オーバーヘッドは実用上無視できる程度であった

## 5. まとめ

*0.25ページ*

- まとめ
- 今後の課題
    - 集団通信関数でのオーバーヘッドを評価する
    - 先行研究で開発したSDN拡張MPI関数を組み込み、性能を評価する
    - マイクロベンチマークより複雑な、実用されているシミュレーションプログラム
        で性能を評価する

## 参考文献

*0.25ページ*

